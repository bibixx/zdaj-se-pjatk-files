<!DOCTYPE HTML PUBLIC "-//W3C//DTD html 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="pragma" content="no-cache">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-2">
<meta http-equiv="Content-Language" content="pl">
<title></title>
<meta name="Keywords" content="s³owa kluczowe">
<meta name="Description" content="">
<LINK REL="stylesheet" TYPE="text/css" HREF="main.css">
<script language="JavaScript" src="skrypty.js" type="text/javascript"></script>
</head>
<body bgcolor="white" leftmargin="0" topmargin="0" marginwidth="0" marginheight="0">
<table width="100%" cellspacing="4" cellpadding="4" border="0">
<tr>
    <td><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td align="left"><A HREF="index72.html" TARGET="_top"  class="NAWIGACJA">&#171;&nbsp;poprzedni punkt</a>&nbsp;</td><td align="right">&nbsp;<A HREF="index74.html" TARGET="_top" class="NAWIGACJA">nastêpny punkt&nbsp;&#187;</a></td></tr></table><br clear="all"><A NAME="EDU.wyklad.punkt 4"></A><div class="tytulpunktu">4. Podejmowanie decyzji: instrukcje if oraz if-else</div>

<a name="W9.4"></a><A NAME="EDU.skorowidz.termin decyzja podejmowanie 73_580"></A> <p>
Znana nam ju¿<A NAME="EDU.skorowidz.termin instrukcja_if 73_581"></A> instrukcja if ma postaæ:<br>

<div class="syntax">
<br>
<br>
<b>if</b>  (<i><b>war</b></i>)  <i><b>ins</b></i><br>
<br>

gdzie:<br>
<ul>
<li>wyr - warunek - dowolne wyra¿enie, maj±ce typ wyniku boolean</li><li>ins - dowolna instrukcja (w tym grupuj±ca)<br></li>
</ul>
<b>Dzia³anie</b>: instrukcja <i><b>ins</b></i> jest wykonywana wtedy i tylko wtedy, gdy warto¶ci± wyra¿enia <i><b>war</b></i> jest true
</div>

<br>
<p><A NAME="EDU.skorowidz.termin instrukcja_if-else 73_582"></A> Instrukcja if-else rozszerza dzia³anie instrukcji if. Ma ona postaæ.<br>

<div class="syntax"><br>
<br>
<b>if</b> (<i><b>war</b></i>) <i><b>ins1</b></i><br>
<b>else</b><i><b>ins2</b></i><br>
<br>

gdzie:<br>
<ul>
<li>wyr - warunek - dowolne wyra¿enie, maj±ce typ wyniku boolean</li><li>ins1, ins2 - dowolne instrukcje (w tym grupuj±ce)<br></li>
</ul>
<b>Dzia³anie</b>: instrukcja <i><b>ins1</b></i> jest wykonywana wtedy i tylko wtedy, gdy warto¶ci± wyra¿enia <i><b>war</b></i> jest true. Je¿eli warto¶ci± wyra¿enia <b>war</b> jest <b>false</b> - wykonywana jest instrukcja <b>ins2</b>
</div>

<br>
<p>

Ró¿nica pomiêdzy zastosowaniem instrukcji if  oraz if-else mo¿na zobaczyæ wyra¼nie na<br>

poni¿szych fragmentach kodu:<br>
<br>

if (a == b) c = d;<br>

c = e;<br>

System.out.println( a + " " + b  + " " + c + " " + d);<br>
<br>

oraz<br>
<br>

if (a == b) c = d;<br>

else c = e;<br>

System.out.println( a + " " + b  + " " + c + " " + d);<br>
<br>

W pierwszym fragmencie instrukcja c = d; wykonana zostanie tylko wtedy, gdy
warto¶æ zmiennej a bêdzie równa warto¶ci zmiennej b. Niezale¿nie jednak od
tego, czy warunek ten zajdzie czy nie - bezpo¶rednio po wykonaniu instrukcji
if zmiennej c zostanie przypisana warto¶æ zmiennej e (if jest wiêc tu bez
sensu!). Nastêpnie wyniki zostan± wyprowadzone na standardowe wyj¶cie.<br>

W drugim fragmencie zmienna c bêdzie mia³a rzeczywi¶cie warto¶æ zale¿n± od
tego czy a == b czy te¿ nie (wykonane zostanie przypisanie albo c = d  albo
c = e). Potem wyniki powêdruj± na wyj¶cie.<br>

Przyk³ad ten nie znaczy oczywi¶cie, ¿e zawsze trzeba stosowaæ instrukcjê if-else, a samo if ma mniejsze znaczenie. <br>
<br>

Warto zauwa¿yæ, ¿e instrukcjami ins1 i ins2 (w syntaktycznym opisie instrukcji
if-else) mog± byæ równie¿ instrukcje if. Pozwala to sprawdzaæ rozga³êzione
warunki np.<br>

<pre>
char op;
double a, b, r;
...
if (op == '+') r = a + b;
else if (op == '-') r = a - b;
     else if (op == '*') r = a*b;
          else if (op == '/') r = a/b;
               else System.out.println("B³êdny kod operacji");
</pre>

<p>
Przy takich okazjach powstaje kwestia: które else odpowiada któremu if ?
Zasada jest prosta: danemu else odpowiada pierwsze poprzedzaj±ce go i znajduj±ce
siê w tym samym bloku if nie maj±ce jeszcze swojej "pary" w postaci else.
Wciêcia - poprawiaj±ce czytelno¶æ - programu w ¿aden sposób nie decyduj±
o odpowiednio¶ci if i else.<br>

Je¶li kto¶ na przyk³ad napisze:<br>
<br>

        if (a &gt;= 0) if (a &lt;= 100) System.out.println( "a w przedziale od 0 do 100");<br>

        else System.out.println("a mniejsze od 0"); <br>
<br>

to bêdzie to oczywisty b³±d.<br>
<br>

Tak± konstrukcjê mo¿na i nale¿y oczywi¶cie zaprogramowaæ inaczej ( if (a
&gt;= 0 &amp;&amp; a &lt;= 100) ... ), ale gdyby siê kto¶ upar³ przy zastosowaniu
podwójnego if, to nale¿a³oby to zapisaæ tak<br>
<br>

        if (a &gt;= 0) { <br>

           if (a &lt;= 100) System.out.println("a w przedziale od 0 do 100"); <br>

        }<br>

        else System.out.println("a mniejsze od 0"); <br>
<br>

Zastosowanie nawiasów klamrowych (uczynienie bloku z drugiej instrukcji if)
rozwi±zuje problem, bowiem<A NAME="EDU.skorowidz.termin if-else dopasowanie 73_583"></A> dopasowanie if i else odbywa siê zawsze tylko
w ramach tego samego bloku.<br>
<br><A NAME="EDU.skorowidz.termin czêste_b³êdy_przy_stosowaniu_instrukcji_if_oraz_if-else 73_584"></A> 
<div class="notec">Czêste b³êdy przy stosowaniu instrukcji if oraz if -else, na które trzeba zwracaæ szczególn± uwagê.<br>
<br>

A. Z³e dopasowanie if i else w przypadku kilku instrukcji if (omówione przed chwil±)<br>
<br>

B. Stawianie ¶rednika po nawiasie zamykaj±cym warunek instrukcji if np. :<br>
<br>

    if (a &gt; b);<br>

        System.out.println("a &gt; b"); // niezale¿nie od tego czy a&gt;b !<br>
<br>

C. Zapomnienie nawiasu zamykaj±cego instrukcjê grupuj±c± np.<br>
<br>

    if (a &gt; b) {<br>

       c = a + b;<br>

       d = e + f;<br>

    else  c = d + f;   <br>
<br>

</div>

<br>

<div class="important">Szczególnie czêstym b³êdem przy sprawdzaniu wielu warunków (które mog±
siê na siebie "nak³adaæ") jest stosowanie instrukcji if bez else, nie uwzglêdnienie
wszystkich mo¿liwo¶ci  lub nieprawid³owa kolejno¶æ sprawdzania warunków.
<br>

B³êdy te s± szczególnie niebezpieczne, gdy¿ dotycz± logiki programu i nie mog± byæ wykryte przez kompilator
</div>

<br>
<p>

Np. je¶li kto¶ chce powiedzieæ co¶ o liczbie a (czy jest du¿a, ¶rednia, ma³a) to móg³by zapisaæ to w ten sposób:<br>

<pre>
     if (a &gt;= 1000) System.out.println("Du¿a liczba")
     if (a &gt;= 100) System.out.println("¦rednia liczba")
     if (a &gt;= 10) System.out.println("Ma³a liczba")
</pre>

<div class="listing33r">Du¿a liczba<br>

¦rednia liczba<br>

 Ma³a liczba</div>
 
<div class="ddd"><br>
co jest oczywistym b³êdem, bo je¶li a = 1000, ten fragment
wyprowadzi na konsolê wzajemnie wykluczaj±c± siê informacjê.
</div>

<br>
<p>
Ach, potrzebne jest else, ale uwaga - kolejno¶æ sprawdzania warunków jest istotna.<br>

Gdyby kto¶ nie przywi±zywa³ do niej istotnej wagi, móg³by zapisaæ:<br>

<pre>
     if (a &gt;= 10) System.out.println("Ma³a liczba");
     else if (a &gt;= 100) System.out.println("¦rednia liczba");
          else  if (a &gt;= 1000) System.out.println("Du¿a liczba");
</pre>

<p>
co znowu daje ca³kiem niepoprawny wynik dla a = 1000: napis "Ma³a liczba"<br>

Dopiero zastosowanie else przy w³a¶ciwej kolejno¶ci warunków da  (przy a = 1000) w³a¶ciwy wynik "Du¿a liczba". <br>

<pre>
     if (a &gt;= 1000) System.out.println("Du¿a liczba");
     else if (a &gt;= 100) System.out.println("¦rednia liczba");
          else if (a &gt;= 10) System.out.println("Ma³a liczba");

</pre>

<p>
Zauwa¿my jednak, ¿e temu fragmentowi brakuje "zupe³no¶ci": co siê stanie
je¶li a równa siê np. 1? Nie dostaniemy ¿adnej informacji! Potrzebne jest
zatem jeszcze jedno ("zamykaj±ce") else, które bêdzie obs³ugiwaæ wszystkie
nie uwzglêdnione warunki.<br>

Na przyk³ad:<br>

<pre>
     if (a &gt;= 1000) System.out.println("Du¿a liczba");
     else if (a &gt;= 100) System.out.println("¦rednia liczba");
          else if (a &gt;= 10) System.out.println("Ma³a liczba");
               else System.out.println("Liczba mikra, bo mniejsza od 10")

</pre>

<p>

Czasem nie stosowanie else przy <b>wykluczaj±cych siê</b> warunkach nie prowadzi
do b³êdów w programie, ale - na pewno nalezy do z³ego stylu i powoduje niepotrzebne
sprawdzanie warunków, o których ju¿ wiadomo, ¿e s± fa³szywe.<br>
<br>

Na przyk³ad je¶li tex jest typu String, to poni¿szy fragment programu:<br>
<br>

if (txt.equals("Ala")) a = 1;<br>

if (txt.equals("kot")) a = 2;<br>

if (txt.equals("koñ")) a = 3;<br>
<br>

wykona siê bezb³êdnie i da prawidlowe wyniki, ale je¶li txt jest "Ala", to
niepotrzebnie sprawdzane s± pozosta³e warunki ("kot" i "koñ").<br>
<br><A NAME="EDU.skorowidz.termin instrukcja_if praktyczny_przyk³ad 73_585"></A> Rozwa¿my teraz praktyczny przyk³ad zastosowania instrukcji if oraz if-else.<br>

Spróbujemy zbudowac prost± klasê symuluj±c± dzia³anie bankomatu.<br>

Bankomat:<br>
<ul>
<li>pyta o PIN</li><li>sprawdza czy podany PIN jest w³a¶ciwy</li><li>je¶li tak - pyta o kwotê do wyp³aty; je¶li nie - przerywa transakcjê</li><li>sprawdza, czy kwota mie¶ci siê w limicie dziennym</li><li>je¶li tak - dokonuje wyp³aty; je¶li nie - przerywa transakcjê.<br></li>
</ul>

<p>
Z punktu widzenia u¿ytkownika bankomatu wa¿ne jest tylko to, ¿e bankomat
pyta o PIN a nastêpnie o kwotê do wyp³aty i (ewentualnie) j± wyp³aca.<br>

Zatem klasa Bankomat pwoinna dostarczyæ jej u¿ytkownikom dwóch odpowiadaj±cych tym dzia³aniom metod nazwijmy je: <b>askPin</b>  (zapytaj o pin) i <b>askAmmountAndWithdraw</b> (zapytaj o kwotê i wyp³aæ).<br>
<br>

Wszelkie sprawdzenia poprawno¶ci wprowadzonych danych (oraz akceptacja kwoty
do wyp³aty) powinny siê odbywaæ wewnêtrz klasy Bankomat i nie obarczaæ u¿ytkowników
tej klasy. Ci powinni tylko móc u¿yæ w/w metod i ew. móc sprawdziæ, czy metody
te zakoñczy³y swoje dzia³anie pomy¶lnie czy te¿ nie (na skutek braku akceptacji
PINu czy kwoty). Z tego sprawdzenia na razie nie bêdziemy korzystaæ, zatem
program g³ówny symuluj±cy dzia³anie bankomatu i korzystaj±cy z gotowej klasy
Bankomat móg³by wygl±daæ tak:<br>
<br>

<pre>
class BankomatTest {

  public static void main(String[] args) {

    Bankomat b = new Bankomat();

    b.askPin();
    b.askAmmountAndWithdraw();

    System.exit(0);

  }
}
</pre>

<p>

A jego dzia³anie pokazuje nastêpuj±ca sekwencja dialogów (generowanych przez klasê Bankomat):<br>
<p><img src="images/bankomat1-9.jpg" alt="Rys" width="293" height="119" border="1" align="Right">
<br>
<br>
wprowadzanie numeru PIN:<br>
<br clear="all">
<br>

<img src="images/bankomat2-9.jpg" alt="Rys" width="293" height="119" border="1" align="Right">
<br>
<br>
wprowadzenie kwoty do wyp³aty:<br>
<br clear="all">
<br>

<img src="images/bankomat3-9.jpg" alt="Rys" width="268" height="113" border="1" align="Right">
<br>
<br>
po jej zakceptowaniu - wyp³ata:<br>
<br clear="all">
<br>

<p>

Gdyby numer PIN okaza³ siê nieprawid³owy - to klasa Bankomat powinna o tym
poinformowaæ w wywo³aniu metody askPin (i oczywi¶cie nie dopu¶ciæ do pytania
o kwotê), a gdyby ¿±dana kwota przekracza³a limit - równie¿ poinformowaæ
i nie dopu¶ciæ do wyp³aty:<br>
<br>

<p>
<img src="images/bankomat4-9.jpg" alt="Rys" width="268" height="113" border="1" align="Left">
<img src="images/bankomat5-9.jpg" alt="Rys" width="268" height="113" border="1" align="Right">
<br clear="all">
<br>

<div class="notel">Uwaga. Nie mo¿emy teraz sprawdzaæ, czy podana kwota do wyp³aty jest liczb±
ca³kowit±, bo jeszcze nie omówili¶my zgadnieñ zwi±zanych z wyj±tkami. Uzupe³nimy
to pó¼niej
</div>  

<div class="ddd"><br>
Istotn± rolê bêdzie w niej odgrywaæ sprawdzanie poprawno¶ci wprowadzanych
danych, które zapiszemy w³a¶nie za pomoc± instrukcji if-else.
</div>
<br clear="all">

<br>

<p>
Zobaczmy teraz jak wygl±da klasa Bankomat.<br>

<p>
Oczywi¶cie, bankomat - sprawdzaj±c dane - komunikuje siê z jakim¶ "kartowym"
czy bankowym, centrum. W naszym programie bêdzie go (w uproszczony sposób)
reprezentowaæ klasa CardIdent (na razie potraktujmy j± jako dan±, bo jej
konstrukcja wykracza poza omówiony dot±d materia³). <br>

Dla naszej klasy Bankomat wa¿ne jest, by rozpoczynaj±c dzia³anie nawi±za³a
³aczno¶c z klas± CardIdent, co symulujemy w konstruktorze klasy Bankomat
poprzez wywo³anie statycznej metody klasy CardIdent - init().<br>
<br>

W metodzie <b>askPin()</b> - po pobraniu w dialogu wej¶ciowym pin-u - bankomat
zwraca siê do klasy CardIdent o potwierdzenie numeru pin i o kwotê limitu
zwi±zan± z dan± kart± (skorzystamy tu ze statycznej metody <b>CardInit.getLimit()</b>, która zwraca aktualny limit lub -1, gdy numer pin jest wadliwy):<br>
<br>

       limit = CardInit.getInit()<br>
<br>

Je¿eli pin jest Ok, to zapisujemy dane: pin oraz bie¿±cy limit w prywatnych polach klasy Bankomat (<b>currentPin</b> i <b>currentLimit</b>
). Zwróæmy uwagê: informacje te s± niedostêpne dla ¿adnej innej klasy oprócz
Bankomatu. Metoda askPin() zwraca warto¶c true, je¶li wszystko siê powiod³o
i false - je¶li klient zrezygnowal z transakcji lub wprowadzi³ wadliwy pin.<br>
<br>

<div class="notel">Przypomnijmy, ¿e uzyskana w dialogu kwota do wyp³aty jest napisem. Musimy
go przekszta³ciæ na liczbê za pomoc± metody Integer.parseInt()
</div>

<div class="ddd"><br>
Metoda askAmmountAndWithdraw
pyta o kwotê do wyplaty - bêdzie j± przechowywac w zmiennej ammount (ale
tylko w przypadku, gdy jest ju¿ ustalony pin; je¶li  pin by³ wadliwy, to
pole currentPin zawiera null i metoda konczy dzia³anie z wynikem false -
nie bêdzie wyplaty; to zapewniamy w pierwszym wierszu metody, pisz±c if (currentPin
== null) return false;).
</div>

<br clear="all">

<p>
Je¶li kwota do wyp³aty przekracza limit - to do wyp³aty te¿ nie dochodzi
i pojawia siê odpowiedni komunikat. W przeciwnym razie - kwota jest wyp³acana,
do centrum kartowego posy³any jest komunikat o wyp³aconej kwocie po to, by
ew. zmniejszyæ dzienny limit (  CardIdent.changeLimit(currentPin, ammount);
), a warto¶ci pól currentPin i currentLimit s± zerowane w przygotowaniu do
nastêpnej transakcji.<br>
<br>

<pre>
import javax.swing.*;

public class Bankomat {

  private static String CANCEL_MSG = "Zrezygnowano z transakcji. Do widzenia";
  private String currentPin;
  private int  currentLimit;

  public Bankomat() {
    CardIdent.init();
  }

  public boolean askPin() {
    String pin = ask("Wprowadz numer PIN:");
    boolean pinOk = false;
    int limit = 0;
    if (pin == null)  say(CANCEL_MSG);
    else {
      limit =  CardIdent.getLimit(pin);
      if (limit == -1) say("Wadliwy PIN");
      else  {
        pinOk = true;
        currentPin = pin;
        currentLimit = limit;
      }
    }
    return pinOk;
  }

  public boolean askAmmountAndWithdraw() {
    if (currentPin == null) return false;
    boolean withdrawAccepted = false;
    String request = ask("Podaj kwote do wyplaty:");
    if (request == null) say(CANCEL_MSG);
    else {
      int ammount = Integer.parseInt(request);
      if (ammount &gt; currentLimit) say("Limit przekroczony.");
      else {
        CardIdent.changeLimit(currentPin, ammount);
        say("Wyplacam kwote : " + ammount + " zl");
        withdrawAccepted = true;
        }
    }
    currentPin = null;
    return withdrawAccepted;
  }

  private String ask(String txt) {
    return JOptionPane.showInputDialog(txt);
  }

  private void say(String txt) {
    JOptionPane.showMessageDialog(null, txt);
  }
</pre>

<p>Zwróæmy te¿ uwagê na dwa elementy:<br>
<ul>
<li>dla u³atwienia sobie ¿ycia w klasie Bankomat zawarli¶my dwie metody
dialogowe - ask i say; uczynili¶my je jednak prywatnymi, bowiem maj± znaczenie
tylko dla klasy Bankomat i nie powinny byæ udostêpnione u¿ytkownikom tej
klasy</li>

<li>komunikat o rezygnacji z transakcji (który pojawia siê gdy
u¿ytkownika zamyka okno dialogowe np. pzrycsikiem Cancel) uczynili¶my sta³±
statyczn± w klasie; sta³± - poniewa¿ jest on wykorzystywany w dwóch miejscach
(osczêdno¶æ pisania i ³atwo¶æ zmiany) i poniewa¿ nie ma sensu; statyczn±
- poniewa¿ nie ma sensu by by³ on zawarty w ka¿dym obiekcie klasy Bankomat.<br></li>
</ul>

<p>
W katalogu samples\bankomat9 znajduj± siê wszystkie omawiane klasy. <br>

Informacje niezbêdne do testowania programu:<br><br>

<table cellpadding="2" cellspacing="2" border="1" width="100%">
<tbody><tr><td valign="Top">Poprawne PINy<br></td><td valign="Top">Limit <br></td></tr><tr><td valign="Top">1234<br></td><td valign="Top">200<br></td></tr><tr><td valign="Top">2345<br></td><td valign="Top">300<br></td></tr><tr><td valign="Top">3456<br></td><td valign="Top">400<br></td></tr><tr><td valign="Top">4567<br></td><td valign="Top">500<br></td></tr><tr><td valign="Top">5678<br></td><td valign="Top">500<br></td></tr><tr><td valign="Top">6789<br></td><td valign="Top">500<br></td></tr></tbody>
</table>
<p><br clear="all"><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td align="left"><A HREF="index72.html" TARGET="_top"  class="NAWIGACJA">&#171;&nbsp;poprzedni punkt</a>&nbsp;</td><td align="right">&nbsp;<A HREF="index74.html" TARGET="_top" class="NAWIGACJA">nastêpny punkt&nbsp;&#187;</a></td></tr></table></td>
</tr>
</table>
</body>
</html>
