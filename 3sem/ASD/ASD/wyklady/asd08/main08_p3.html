<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="pragma" content="no-cache">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-2">
<meta http-equiv="Content-Language" content="pl">
<title></title>
<meta name="Keywords" content="s³owa kluczowe">
<meta name="Description" content="">
<LINK REL="stylesheet" TYPE="text/css" HREF="../main.css">
<LINK REL="stylesheet" TYPE="text/css" HREF="../style.html">
<script language="JavaScript" src="../skrypty.js" type="text/javascript"></script>
</head>
<body bgcolor="whitesmoke" leftmargin="8" topmargin="8" marginwidth="8" marginheight="8">
<!--body bgcolor="whitesmoke" leftmargin="0" topmargin="0" marginwidth="0" marginheight="0"-->
<!--table width="100%" cellspacing="4" cellpadding="4" border="0"-->
<!--tr-->
    <!--td--><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr>
<td align="left"><A HREF="main08_p2.html" TARGET="main"  class="NAWIGACJA">&#171;&nbsp;poprzedni punkt</a>&nbsp;</td>
<td align="right">&nbsp;<A HREF="main08_p4.html" TARGET="main" class="NAWIGACJA">nastêpny punkt&nbsp;&#187;</a></td></tr></table>
<br clear="all">
<A NAME="EDU.wyklad.punkt 3"></A><br clear="all"><div class="tytulpunktu">
3. Operacja wstawiania do AVL</div>

<p>Operacja wstawiania elementu do drzewa AVL, etykietowanego elementami zbioru 
Et,</p>

<p style="text-align: center">insert : AVL <span lang="en"><font face="Symbol">´</font></span> Et<font face="Symbol">
<span lang="en">&reg;</span></font> AVL,&nbsp; </p>

<p>mo¿e byæ zrealizowana tak jak dla drzew 
binarnych poszukiwañ. Problem polega na tym, ¿e nie zawsze otrzymujemy w wyniku 
drzewo wywa¿one. Metoda wstawiania elementu do drzewa AVL sk³ada siê wiêc z 
trzech etapów:</p>

<ol>
  <li>znalezienie 
wierzcho³ka, do którego mo¿na do³±czyæ now± etykietê (o ile nie by³o jej jeszcze 
  w drzewie),</li>
  <li>utworzenie nowego wierzcho³ka i dowi±zanie go do drzewa w znalezionym (w 
  punkcie 1) wê¼le, oraz</li>
  <li>poprawienie warto¶ci wag wierzcho³ków na ¶cie¿ce poszukiwania, od ojca nowo-wstawionego 
  wierzcho³ka w kierunku korzenia drzewa,</li>
  <li>wykonanie rotacji wzglêdem pierwszego napotkanego wierzcho³ka, którego 
  waga wynosi +2 lub -2, o ile taki istnieje.</li>
</ol>

<p>Przyk³ad 3.1</p>

<p>Kolejne etapy tworzenia drzewa AVL z elementów 1,2,3,5,4 przedstawiono na 
rysunku 8.6(a) i 8.6(b).<BR></p>
<table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="60%" id="AutoNumber1">
  <tr>
    <td width="50%">
    <img border="0" src="Rysunki/Rysunek8_6a.gif" width="250" height="250"></td>
    <td width="50%">
    <img border="0" src="Rysunki/Rysunek8_6b.gif" width="250" height="250"></td>
  </tr>
</table>
&nbsp;<p>Po do³±czeniu etykiety 3, otrzymane drzewo nie jest drzewem AVL, 
poniewa¿ waga w korzeniu wynosi teraz -2.&nbsp; Prosta rotacja w lewo pozwoli 
jednak zrównowa¿yæ to drzewo, jak pokazano na rysunku 8.6 (a).&nbsp; Wstawienie 
etykiety 5 do prawego poddrzewa powoduje zwiêkszenie wysoko¶ci ca³ego drzewa,&nbsp; 
ale wagi s± nadal dopuszczalne (por. rysunek 8.6(b)). Nowy element 4 równie¿ 
zwiêksza wysoko¶æ, ale teraz waga wierzcho³ka 3 nie jest odpowiednia, wynosi 
bowiem -2. £atwo zauwa¿yæ, ¿e prosta rotacja w lewo wzglêdem 3 nie poprawi 
sytuacji. Jednak zastosowanie rotacji podwójnej doprowadza drzewo do stanu 
wywa¿enia, por. ostatni z grafów na rysunku 8.6(b). <font face="Wingdings">J</font></p>
<p>Sformu³ujemy teraz ogólne zasady wywa¿ania, gdy do drzewa AVL wstawiamy nowy 
element. Regu³y postêpowania zale¿± od tego jakie s± aktualne wagi wierzcho³ków 
i gdzie zostanie dowi±zany nowy wierzcho³ek.</p>
<p>Niech D bêdzie drzewem AVL, D = &lt;LD, r, PD&gt;, do którego wstawiamy etykietê e. 
Niech D' oznacza drzewo otrzymane w wyniku zastosowania algorytmu insert(e,D) 
dla drzew BST. Za³ó¿my, ¿e nowy wierzcho³ek z etykiet± e zosta³ dowi±zany w 
lewym poddrzewie drzewa D i ¿e spowodowa³o to zwiêkszenie wysoko¶ci drzewa LD, 
ale LD nadal pozostaje drzewem wywa¿onym. Wynika st±d, ¿e przed wstawieniem 
nowego wierzcho³ka, waga w korzeniu drzewa LD musia³a byæ równa 0. Zachodz± 
nastêpuj±ce przypadki:</p>
<p>1. Je¿eli waga w wierzcho³ku drzewa D wynosi³a 0, to po do³±czeniu e, wynosi 
1. Otrzymane drzewo D' jest wiêc drzewem AVL, chocia¿ jego wysoko¶æ jest o 1 
wiêksza ni¿ drzewa D.</p>
<p>2. Je¿eli waga w wierzcho³ku drzewa D wynosi³a -1, to po do³±czeniu e wynosi 
0. Otrzymane drzewo jest wywa¿one, a jego wysoko¶æ jest taka sama jak drzewa D. </p>
<p>3. Je¿eli waga w wierzcho³ku drzewa D wynosi³a +1, to po do³±czeniu e wynosi 
+2. Zatem drzewo D' nie jest wywa¿one. Typ u¿ytej rotacji zale¿y od tego, czy e 
zosta³o do³±czone do lewego, czy do prawego poddrzewa drzewa LD.</p>
<p>3a. Element e&nbsp; znajduje siê w lewym poddrzewie drzewa LD. Waga korzenia 
drzewa LD zmieni³a siê z 0 na +1. Zastosowanie pojedynczej rotacji w prawo 
pozwoli wywa¿yæ otrzymane drzewo. Na rysunku rysunek 8.7 (a) przedstawiono 
opisan± w tym przypadku sytuacjê przed i po wykonaniu wstawienia elementu e, a 
na rysunku 8.7(b) rezultat zastosowania prostej rotacji w prawo. Zauwa¿my, ¿e 
wysoko¶æ otrzymanego drzewa jest taka sama jak wysoko¶æ danego drzewa przed 
wstawieniem elementu e.</p>
<p>&nbsp;</p>
<table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="60%" id="AutoNumber2">
  <tr>
    <td width="50%">
    <img border="0" src="Rysunki/Rysunek8_7a.gif" width="250" height="250"></td>
    <td width="50%">
    <img border="0" src="Rysunki/Rysunek8_7b.gif" width="250" height="250"></td>
  </tr>
</table>
<p>&nbsp;</p>
<table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="60%" id="AutoNumber3">
  <tr>
    <td width="50%">
    <img border="0" src="Rysunki/Rysunek8_7c.gif" width="250" height="250"></td>
    <td width="50%">
    <img border="0" src="Rysunki/Rysunek8_7d.gif" width="250" height="250"></td>
  </tr>
</table>
<p>3b. Element e zosta³ do³±czony do prawego poddrzewa drzewa LD. Waga drzewa LD 
zmieni³a siê wiêc z 0 na -1. Otrzymane drzewo nie jest wywa¿one. Zastosowanie 
rotacji podwójnej w prawo pozwoli je jednak wywa¿yæ. Sytuacja opisana w tym 
przypadku, jest przedstawiona na rysunku 8.8(a). Skre¶lone wagi odpowiadaj± 
stanowi drzewa przed wykonaniem do³±czenia etykiety e. Wynik wywa¿ania jest 
natomiast przedstawiony na rysunku 8.8(b). Jak poprzednio, zauwa¿my, ¿e wysoko¶æ 
drzewa po wykonaniu rotacji jest taka sama jak wysoko¶æ drzewa D. </p>
<table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="60%" id="AutoNumber4">
  <tr>
    <td width="50%">
    <img border="0" src="Rysunki/Rysunek8_8a.gif" width="250" height="250"></td>
    <td width="50%">
    <img border="0" src="Rysunki/Rysunek8_8b.gif" width="250" height="250"></td>
  </tr>
</table>
<p>&nbsp;</p>
<table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="60%" id="AutoNumber5">
  <tr>
    <td width="50%">
    <img border="0" src="Rysunki/Rysunek8_8c.gif" width="250" height="250"></td>
    <td width="50%">
    <img border="0" src="Rysunki/Rysunek8_8d.gif" width="250" height="250"></td>
  </tr>
</table>
<p>Analogicznie, je¿eli nowy wierzcho³ek z etykiet± e zosta³ dowi±zany w prawym 
poddrzewie drzewa D i spowodowa³o to zwiêkszenie wysoko¶ci drzewa PD, 
ale PD nadal pozostaje drzewem wywa¿onym. Wynika st±d, ¿e przed wstawieniem 
nowego wierzcho³ka, waga w korzeniu drzewa PD musia³a byæ równa 0. Zachodz±&nbsp; 
trzy nastêpuj±ce przypadki:</p>
<p>1. Je¿eli waga w wierzcho³ku drzewa D wynosi³a 0, to po do³±czeniu e, wynosi 
-1. Otrzymane drzewo D' jest wiêc drzewem AVL, chocia¿ jego wysoko¶æ jest o 1 
wiêksza ni¿ drzewa D.</p>
<p>2. Je¿eli waga w wierzcho³ku drzewa D wynosi³a +1, to po do³±czeniu e wynosi 
0. Otrzymane drzewo jest wywa¿one, a jego wysoko¶æ jest taka sama jak drzewa D. </p>
<p>3. Je¿eli waga w wierzcho³ku drzewa D wynosi³a -1, to po do³±czeniu e wynosi 
-2. Zatem drzewo D' nie jest wywa¿one. Typ u¿ytej rotacji zale¿y od tego, czy e 
zosta³o do³±czone do prawego, czy do lewego poddrzewa drzewa PD. W pierwszym 
przypadku opisanym na rysunku 8.7(c) zastosujemy prost±&nbsp; rotacjê w lewo, 
która wywa¿y drzewo (por. 8.7 (d)). W drugim przypadku, przedstawionym na 
rysunku 8.8(c) zastosujemy podwójn± rotacjê w lewo. Otrzymany wynik jest 
przedstawiony na rysunku 8.8(d).</p>
<p><b>Pytanie 3:&nbsp; </b>

Ile co najwy¿ej rotacji trzeba wykonaæ, je¶li do drzewa&nbsp; AVL o n 
wierzcho³kach do³±czamy jeden element? <BR>
 
</p>
 
<FORM>
<INPUT class="GUZIK" TYPE='button' VALUE='Zobacz odpowied¼' NAME='Klik0' 
onClick="napis(this.form,'Co najwy¿ej jedn± rotacjê.');">
</form>

<p><br clear="all"><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr>
<td align="left"><A HREF="main08_p2.html" TARGET="main"  class="NAWIGACJA">&#171;&nbsp;poprzedni punkt</a>&nbsp;</td>
<td align="right">&nbsp;<A HREF="main08_p4.html" TARGET="main" class="NAWIGACJA">nastêpny punkt&nbsp;&#187;</a></td></tr></table><!--/td-->
<!--/tr-->
<!--/table-->
</body>
</html>